@using System.Globalization
@model StockExchange.Web.Models.Simulation.SimulationResultViewModel

@{
    ViewBag.Title = "Simulation Results";
}

<div class="row">
    <div class="col-sm-6">
        <div id="simulationresult-table-container">
            <div class="box box-info">
                <div class="box-header with-border">
                    <h3 class="box-title">Results</h3>
                </div>
                <div class="box-body">
                    <div class="table-responsive">
                        <table class="table no-margin">
                            <thead>
                                <tr>
                                    <th>Start budget</th>
                                    <th>Total simulation value</th>
                                    <th>Percentage profit</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>@Model.StartBudget</td>
                                    <td>@Model.TotalSimulationValue</td>
                                    <td>
                                        @if (@Model.PercentageProfit > 0)
                                        {
                                            <i class="fa fa-arrow-up icon-stock-up"></i>
                                            <span class="text-success">@Model.PercentageProfit%</span>
                                        }
                                        else
                                        {
                                            <i class="fa fa-arrow-down icon-stock-down"></i>
                                            <span class="text-danger">@Model.PercentageProfit%</span>
                                        }
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="table-responsive">
                        <table class="table no-margin">
                            <thead>
                                <tr>
                                    <th></th>
                                    <th>Date</th>
                                    <th>Value</th>
                                    <th>Percentage gain/loss</th>
                                </tr>
                            </thead>
                            <tbody>
                                @{
                                    string gainDate = Model.MaximalGainOnTransaction?.TransactionDate.ToShortDateString() ?? "-";
                                    string gainPercentage = (Model.MaximalGainOnTransaction?.PercentageIncome ?? 0.0) + "%";
                                    string maxGainValue = ((Model.MaximalGainOnTransaction?.ValueAfter ?? 0m) - (Model.MaximalGainOnTransaction?.ValueBefore ?? 0m)).ToString(CultureInfo.InvariantCulture);
                                    <tr>
                                        <th>Maximal gain on transaction</th>
                                        <td>@gainDate</td>
                                        <td>@maxGainValue</td>
                                        <td>
                                            <i class="fa fa-arrow-up icon-stock-up"></i>
                                            <span class="text-success">@gainPercentage</span>
                                        </td>
                                    </tr>
                                    string lossDate = Model.MaximalLossOnTransaction?.TransactionDate.ToShortDateString() ?? "-";
                                    string lossPercentage = (Model.MaximalLossOnTransaction?.PercentageIncome ?? 0.0) + "%";
                                    string maxLossValue = ((Model.MaximalLossOnTransaction?.ValueAfter ?? 0m) - (Model.MaximalLossOnTransaction?.ValueBefore ?? 0m)).ToString(CultureInfo.InvariantCulture);
                                    <tr>
                                        <th>Maximal loss on transaction</th>
                                        <td>@lossDate</td>
                                        <td>@maxLossValue</td>
                                        <td>
                                            <i class="fa fa-arrow-down icon-stock-down"></i>
                                            <span class="text-danger">@lossPercentage</span>
                                        </td>
                                    </tr>
                                    string maximalDate = Model.MaximalSimulationValue?.Date.ToShortDateString();
                                    string minimalDate = Model.MinimalSimulationValue?.Date.ToShortDateString();
                                    string maxValuePercentage = (Model.MaximalSimulationValue?.PercentageIncome ?? 0.0) + "%";
                                    string minValuePercentage = (Model.MinimalSimulationValue?.PercentageIncome ?? 0.0) + "%";
                                    string maxValue = (Model.MaximalSimulationValue?.Value.ToString(CultureInfo.InvariantCulture) ?? "0");
                                    string minValue = (Model.MinimalSimulationValue?.Value.ToString(CultureInfo.InvariantCulture) ?? "0");
                                    <tr>
                                        <th>Maximal simulation value</th>
                                        <td>@maximalDate</td>
                                        <td>@maxValue</td>
                                        <td>
                                            <i class="fa fa-arrow-up icon-stock-up"></i>
                                            <span class="text-success">@maxValuePercentage</span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>Minimal simulation value</th>
                                        <td>@minimalDate</td>
                                        <td>@minValue</td>
                                        <td>
                                            <i class="fa fa-arrow-down icon-stock-down"></i>
                                            <span class="text-danger">@minValuePercentage</span>
                                        </td>
                                    </tr>
                                }
                        </tbody>
                    </table>
                </div>
                    <div class="table-responsive">
                        <table class="table no-margin">
                            <thead>
                                <tr>
                                    <th>Company Name</th>
                                    <th>Quantity</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var transaction in Model.CurrentCompanyQuantity)
                                {
                                    <tr>
                                        <td>@transaction.Key.Code</td>
                                        <td>@transaction.Value</td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-sm-5">
        <div id="simulationlog-table-container">
            <div class="box box-info">
                <div class="box-header with-border">
                    <h3 class="box-title">Transactions Log</h3>
                </div>
                <div class="box-body">
                    <div class="table-responsive">
                        <table class="table no-margin">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Company ID</th>
                                    <th>Price</th>
                                    <th>Quantity</th>
                                    <th>Action</th>
                                    <th>Budget After</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var transaction in Model.TransactionsLog)
                                {
                                    <tr>
                                        <td>@transaction.Date.ToShortDateString()</td>
                                        <td>@transaction.Company.Code</td>
                                        <td>@transaction.Price.ToString("0.00")</td>
                                        <td>@transaction.Quantity</td>
                                        <td>@transaction.Action</td>
                                        <td>@transaction.BudgetAfter.ToString("0.00")</td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>